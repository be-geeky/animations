import { ExtensionHasNoTargetError } from '../errors.esnext';
import { useApi } from './api.esnext';
import { useSubscription } from './subscription.esnext';

/**
 * Returns the shipping option the extension is attached to. This hook can only be used by extensions in the following
 * extension targets:
 * - `purchase.checkout.shipping-option-item.render-after`
 * - `purchase.checkout.shipping-option-item.details.render`
 */
function useShippingOptionTarget() {
  const api = useApi();
  if (!api.target || !api.isTargetSelected) {
    throw new ExtensionHasNoTargetError('useShippingOptionTarget', api.extension.target);
  }
  return {
    shippingOptionTarget: useSubscription(api.target),
    isTargetSelected: useSubscription(api.isTargetSelected)
  };
}

export { useShippingOptionTarget };
